function getUserInfo(a){var b=$.Deferred(),c="http://api.twitter.com/1/users/show.json?screen_name=";return $.ajax({url:c+a,dataType:"jsonp",success:b.resolve}),b.promise()}function getBday(a){var b=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],c=new Date(a),d=c.getDate();return d+=" "+b[c.getMonth()]+" ",d+=c.getFullYear()+" года"}function getWord(a,b,c,d){return word=a%10==1&&a%100!=11?b:a%10>=2&&4>=a%10&&(10>a%100||a%100>=20)?c:d}function getDays(a){var b,c,d=new Date,e=new Date(a),f=d-e;return b=Math.floor(f/1e3/60/60/24),c=getWord(b,"день","дня","дней"),b=b.toString(),b+=" "+c}function tweetMe(a){var b="http://twitter.com/share?url=http%3A%2F%2Fsoulwish.pp.ua%2Ftwitterbday&text=";return b+=getBday(a.created_at),b+=" мой Твиттер День Рождения! @",b+=a.screen_name+" с Твиттером уже ",b+=getDays(a.created_at),b+="&via=tweet_bday",b=b.replace(/ /gi,"%20")}function loadBirthdays(){var a="http://reports.soulwish.pp.ua/twitterAPI.php?callback=",b=1;$.getJSON(a,function(a){tweets.empty(),$.each(a.results,function(a,c){getUserInfo(c.from_user).then(function(a){localStorage[b]=JSON.stringify(a);var c="<li>",d=a.profile_image_url.replace("normal","bigger");c+='<div class="icon"><img src="'+d+'" alt="'+a.name+'" /></div>',c+='<a href="http://twitter.com/'+a.screen_name+'" class="name" target="_blank">'+a.name+"</a>",c+='<span class="bday">'+getBday(a.created_at)+"</span>",c+='<span class="bday">'+getDays(a.created_at)+"</span>",c+='<a href="'+tweetMe(a)+'" title="Твитнуть" class="tweetme">&nbsp;</a>',c+="</li>",tweets.append(c),b++})})}),$.cookie("cache",1)}function loadCachedBirthdays(){tweets.empty();for(var a,b=localStorage.length,c=1;b>=c;c++)if(a=JSON.parse(localStorage[c]),"object"==typeof a){var d="<li>",e=a.profile_image_url.replace("normal","bigger");d+='<div class="icon"><img src="'+e+'" alt="'+a.name+'" /></div>',d+='<a href="http://twitter.com/'+a.screen_name+'" class="name" target="_blank">'+a.name+"</a>",d+='<span class="bday">'+getBday(a.created_at)+"</span>",d+='<span class="bday">'+getDays(a.created_at)+"</span>",d+='<a href="'+tweetMe(a)+'" title="Твитнуть" class="tweetme">&nbsp;</a>',d+="</li>",tweets.append(d)}}!function(){tweets=$(".tweets");var a=new Date;a.setTime(a.getTime()+36e4),$.cookie.json=!0,$.cookie.defaults={expires:a,path:"/twitterbday"},$.ajaxSetup({cache:!0}),null==$.cookie("cache")?loadBirthdays():loadCachedBirthdays(),$(".info").on("click",function(a){a.preventDefault(),$(".infobar").slideToggle("slow"),$(this).toggleClass("active")})}();