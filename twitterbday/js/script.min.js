function getUserInfo(a){var b=$.Deferred(),c="http://api.twitter.com/1/users/show.json?screen_name=";return $.ajax({url:c+a,dataType:"jsonp",success:b.resolve}),b.promise()}function getBday(a){var b=["\u044f\u043d\u0432\u0430\u0440\u044f","\u0444\u0435\u0432\u0440\u0430\u043b\u044f","\u043c\u0430\u0440\u0442\u0430","\u0430\u043f\u0440\u0435\u043b\u044f","\u043c\u0430\u044f","\u0438\u044e\u043d\u044f","\u0438\u044e\u043b\u044f","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f","\u043e\u043a\u0442\u044f\u0431\u0440\u044f","\u043d\u043e\u044f\u0431\u0440\u044f","\u0434\u0435\u043a\u0430\u0431\u0440\u044f"],c=new Date(a),d=c.getDate();return d+=" "+b[c.getMonth()]+" ",d+=c.getFullYear()+" \u0433\u043e\u0434\u0430"}function getWord(a,b,c,d){return word=1==a%10&&11!=a%100?b:a%10>=2&&4>=a%10&&(10>a%100||a%100>=20)?c:d}function getDays(a){var b,c,d=new Date,e=new Date(a),f=d-e;return b=Math.floor(f/1e3/60/60/24),c=getWord(b,"\u0434\u0435\u043d\u044c","\u0434\u043d\u044f","\u0434\u043d\u0435\u0439"),b=""+b,b+=" "+c}function tweetMe(a){var b="http://twitter.com/share?url=http%3A%2F%2Fsoulwish.pp.ua%2Ftwitterbday&text=";return b+=getBday(a.created_at),b+=" \u043c\u043e\u0439 \u0422\u0432\u0438\u0442\u0442\u0435\u0440 \u0414\u0435\u043d\u044c \u0420\u043e\u0436\u0434\u0435\u043d\u0438\u044f! @",b+=a.screen_name+" \u0441 \u0422\u0432\u0438\u0442\u0442\u0435\u0440\u043e\u043c \u0443\u0436\u0435 ",b+=getDays(a.created_at),b+="&via=tweet_bday",b=b.replace(/ /gi,"%20")}function loadBirthdays(){var a="http://search.twitter.com/search.json?callback=?&rpp=15&q=@tweet_bday",b=1;$.getJSON(a,function(a){tweets.empty(),$.each(a.results,function(a,c){getUserInfo(c.from_user).then(function(a){localStorage[b]=JSON.stringify(a);var c="<li>",d=a.profile_image_url.replace("normal","bigger");c+='<div class="icon"><img src="'+d+'" alt="'+a.name+'" /></div>',c+='<a href="http://twitter.com/'+a.screen_name+'" class="name" target="_blank">'+a.name+"</a>",c+='<span class="bday">'+getBday(a.created_at)+"</span>",c+='<span class="bday">'+getDays(a.created_at)+"</span>",c+='<a href="'+tweetMe(a)+'" title="\u0422\u0432\u0438\u0442\u043d\u0443\u0442\u044c" class="tweetme">&nbsp;</a>',c+="</li>",tweets.append(c),b++})})}),$.cookie("cache",1)}function loadCachedBirthdays(){tweets.empty();for(var a,b=localStorage.length,c=1;b>=c;c++)if(a=JSON.parse(localStorage[c]),"object"==typeof a){var d="<li>",e=a.profile_image_url.replace("normal","bigger");d+='<div class="icon"><img src="'+e+'" alt="'+a.name+'" /></div>',d+='<a href="http://twitter.com/'+a.screen_name+'" class="name" target="_blank">'+a.name+"</a>",d+='<span class="bday">'+getBday(a.created_at)+"</span>",d+='<span class="bday">'+getDays(a.created_at)+"</span>",d+='<a href="'+tweetMe(a)+'" title="\u0422\u0432\u0438\u0442\u043d\u0443\u0442\u044c" class="tweetme">&nbsp;</a>',d+="</li>",tweets.append(d)}}(function(){tweets=$(".tweets");var a=new Date;a.setTime(a.getTime()+36e4),$.cookie.json=!0,$.cookie.defaults={expires:a,path:"/twitterbday"},$.ajaxSetup({cache:!0}),null==$.cookie("cache")?loadBirthdays():loadCachedBirthdays(),$(".info").on("click",function(a){a.preventDefault(),$(".infobar").slideToggle("slow"),$(this).toggleClass("active")})})();